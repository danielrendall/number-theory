C EXPECT 0XACE1 = 44257 TO BE FOLLOWED BY 0XE270 = 57968
      PROGRAM LFSR2
      INTEGER PERIOD, ISTART, ILFSR, BVAL
     0LOGICAL START(16), LFSR(16), BIT(16), 
     1        B400(16), ONE(16), ZERO(16),
     2        LSB(16), NLFSR(16), NBIT(16)
      PERIOD = 0
      IB400 = 46080     
      ISTART = 44257
      ILFSR = 44257
      CALL ITOBIT(START, 16, ISTART)
      CALL ITOBIT(LFSR, 16, ILFSR)
      CALL ITOBIT(B400, 16, IB400)
      CALL ITOBIT(ONE, 16, 1)
      CALL ITOBIT(ZERO, 16, 0)
C10    PRINT *,ILFSR
10    CALL AND(LFSR, ONE, LSB, 16)
      CALL BSR(LFSR, NLFSR, 16, 1)
      IF (BVAL(LSB, 16) .EQ. 0) GOTO 15
      CALL XOR(NLFSR, B400, NLFSR, 16)
15    CALL OR(NLFSR, ZERO, LFSR, 16)
      ILFSR = BVAL(LFSR, 16)
      PERIOD = PERIOD + 1
      IF (ILFSR .EQ. ISTART) GOTO 20
      GOTO 10
20    PRINT *, "PERIOD=", PERIOD
      END
