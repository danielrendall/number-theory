      PROGRAM TESTBITOPS
      CALL TBVAL(1)
      CALL TITOBT(2)
      CALL TBSL(3)
      CALL TBSR(4)
      END

      SUBROUTINE TBVAL(T)
      INTEGER T, BVAL
      LOGICAL ARRAY(6)
      DO 100 I=1,6
      ARRAY(I) = .TRUE.
100   CONTINUE
      CALL IXPECT(T, 1, BVAL(ARRAY, 6), 63)
      CALL IXPECT(T, 2, BVAL(ARRAY, 5), 31)
      ARRAY(3)= .FALSE.
      CALL IXPECT(T, 3, BVAL(ARRAY, 6), 55)
      CALL IXPECT(T, 4, BVAL(ARRAY, 5), 27)
      END

      SUBROUTINE TITOBT(T)
      INTEGER T, BVAL
      LOGICAL ARRAY(16)
      CALL ITOBIT(ARRAY, 16, 10000)
      CALL IXPECT(T, 1, BVAL(ARRAY, 16), 10000)
      CALL ITOBIT(ARRAY, 16, 1)
      CALL IXPECT(T, 2, BVAL(ARRAY, 16), 1)
      CALL ITOBIT(ARRAY, 16, 65535)
      CALL IXPECT(T, 3, BVAL(ARRAY, 16), 65535)
      CALL ITOBIT(ARRAY, 16, 0)
      CALL IXPECT(T, 4, BVAL(ARRAY, 16), 0)
      CALL ITOBIT(ARRAY, 16, 32768)
      CALL IXPECT(T, 5, BVAL(ARRAY, 16), 32768)
      END


      SUBROUTINE TBSL(T)
      INTEGER T, BVAL
      LOGICAL ARRAY(16), RES(16)
      CALL ITOBIT(ARRAY, 16, 1000)
      CALL BSL(ARRAY, RES, 16, 0)
      CALL IXPECT(T, 1, BVAL(RES, 16), 1000)
      CALL BSL(ARRAY, RES, 16, 1)
      CALL IXPECT(T, 2, BVAL(RES, 16), 2000)
      CALL BSL(ARRAY, RES, 16, 3)
      CALL IXPECT(T, 3, BVAL(RES, 16), 8000)
      CALL ITOBIT(ARRAY, 16, 32768)
      CALL BSL(ARRAY, RES, 16, 0)
      CALL IXPECT(T, 4, BVAL(RES, 16), 32768)
      CALL BSL(ARRAY, RES, 16, 1)
      CALL IXPECT(T, 5, BVAL(RES, 16), 0)
      END

      SUBROUTINE TBSR(T)
      INTEGER T, BVAL
      LOGICAL ARRAY(16), RES(16)
      CALL ITOBIT(ARRAY, 16, 1000)
      CALL BSR(ARRAY, RES, 16, 0)
      CALL IXPECT(T, 1, BVAL(RES, 16), 1000)
      CALL BSR(ARRAY, RES, 16, 1)
      CALL IXPECT(T, 2, BVAL(RES, 16), 500)
      CALL BSR(ARRAY, RES, 16, 3)
      CALL IXPECT(T, 3, BVAL(RES, 16), 125)
      CALL ITOBIT(ARRAY, 16, 1)
      CALL BSR(ARRAY, RES, 16, 0)
      CALL IXPECT(T, 4, BVAL(RES, 16), 1)
      CALL BSR(ARRAY, RES, 16, 1)
      CALL IXPECT(T, 5, BVAL(RES, 16), 0)
      END
